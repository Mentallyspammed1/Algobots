name: Unified Code Quality

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]

jobs:
  python-quality:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.x'
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install pylint flake8 black google-generativeai
      - name: Run linters
        run: |
          pylint **/*.py > pylint-report.txt || true
          flake8 . --output-file=flake8-report.txt || true
      - name: Run black
        run: black .
      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          commit-message: "style: auto-fix python linting issues"
          title: "Auto-fix Python linting issues"
          body: "This PR contains automated fixes for Python linting issues."
          branch: "auto-fix/python-linting"

  javascript-quality:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
      - name: Install dependencies
        run: npm install
      - name: Run linters
        run: |
          npx eslint . --output-file eslint-report.txt || true
          npx stylelint **/*.css --output-file stylelint-report.txt || true
      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          commit-message: "style: auto-fix js/ts linting issues"
          title: "Auto-fix JS/TS linting issues"
          body: "This PR contains automated fixes for JS/TS linting issues."
          branch: "auto-fix/javascript-linting"
