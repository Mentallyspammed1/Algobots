# Bybit Trading Bot Grimoire

This document serves as your guide to understanding and utilizing the modular Bybit Trading Bot.

## üìú Table of Contents

1.  [Overview](#-overview)
2.  [File Structure](#-file-structure)
3.  [Configuration](#-configuration)
4.  [Crafting Your Strategy](#-crafting-your-strategy)
5.  [Running the Bot](#-running-the-bot)
6.  [Logging](#-logging)

## üìñ Overview

This trading bot is designed with modularity and extensibility in mind. It separates the core trading logic from the strategy, configuration, and logging, making it easy to customize and maintain.

The bot performs the following functions:
- Connects to the Bybit exchange using API keys.
- Fetches real-time and historical market data.
- Loads a custom trading strategy from a separate file.
- Executes trades based on the signals generated by the strategy.
- Provides detailed logging of its operations.

## üìÇ File Structure

Here is a breakdown of the key files in this project:

-   `main.py`: The main entry point to start the bot.
-   `bybit_trader.py`: The core engine of the bot, handling API connections, order execution, and data management.
-   `config.py`: All your configurations in one place, from API keys to trading parameters.
-   `bot_logger.py`: The logging setup.
-   `strategies/`: The directory where your trading strategies reside.
    -   `base_strategy.py`: The abstract base class that all strategies must inherit from.
    -   `strategy_template.py`: A ready-to-use template for creating your own strategies.
-   `requirements.txt`: A list of necessary Python packages.
-   `pybithelp.md`: This file.

## ‚öôÔ∏è Configuration

All settings for the bot are managed in the `config.py` file.

**API Keys:**
It is highly recommended to store your API keys in a `.env` file in the root directory for security.

Create a `.env` file with the following content:
```
BYBIT_API_KEY="YOUR_REAL_API_KEY"
BYBIT_API_SECRET="YOUR_REAL_API_SECRET"
BYBIT_TESTNET="True"
```

The `config.py` file will automatically load these variables.

**Trading Parameters:**
-   `SYMBOL`: The trading pair you want to trade (e.g., "BTCUSDT").
-   `CATEGORY`: The market category (e.g., "linear", "inverse", "spot").
-   `TRADE_QTY_USD`: The desired size of your trades in USD.
-   `STRATEGY_FILE`: The path to your strategy file.

## ‚öîÔ∏è Crafting Your Strategy

Creating a custom strategy is the most exciting part. Follow these steps:

1.  **Duplicate the Template**: Make a copy of `strategies/strategy_template.py` and rename it (e.g., `strategies/my_macd_strategy.py`).

2.  **Rename the Class**: Change the class name inside your new file to something unique (e.g., `MyMACDStrategy`).

3.  **Implement Your Logic**: The magic happens in the `generate_signals` method. This method receives a pandas DataFrame with OHLCV data and must return a DataFrame with a `signal` column.
    -   The `signal` column should contain one of three values for the latest candle: `'buy'`, `'sell'`, or `'hold'`.

    **Example `generate_signals` for a MACD Crossover strategy:**
    ```python
    import pandas as pd
    import talib
    from strategies.base_strategy import BaseStrategy

    class MyMACDStrategy(BaseStrategy):
        def __init__(self):
            super().__init__("MyMACDStrategy")
            self.fast_period = 12
            self.slow_period = 26
            self.signal_period = 9

        def generate_signals(self, dataframe: pd.DataFrame) -> pd.DataFrame:
            df = dataframe.copy()
            
            # Calculate MACD
            macd, macdsignal, _ = talib.MACD(
                df['close'],
                fastperiod=self.fast_period,
                slowperiod=self.slow_period,
                signalperiod=self.signal_period
            )
            
            df['macd'] = macd
            df['macdsignal'] = macdsignal
            df['signal'] = 'hold'

            # Buy signal: MACD crosses above signal line
            if df['macd'].iloc[-1] > df['macdsignal'].iloc[-1] and df['macd'].iloc[-2] <= df['macdsignal'].iloc[-2]:
                df.loc[df.index[-1], 'signal'] = 'buy'
            
            # Sell signal: MACD crosses below signal line
            elif df['macd'].iloc[-1] < df['macdsignal'].iloc[-1] and df['macd'].iloc[-2] >= df['macdsignal'].iloc[-2]:
                df.loc[df.index[-1], 'signal'] = 'sell'

            return df
    ```

4.  **Update `config.py`**: Change the `STRATEGY_FILE` variable in `config.py` to point to your new strategy file.
    ```python
    STRATEGY_FILE = "strategies/my_macd_strategy.py"
    ```

## üöÄ Running the Bot

To unleash your bot, follow these steps:

1.  **Install Dependencies**:
    ```bash
    pip install -r requirements.txt
    ```
    *Note: Installing `TA-Lib` can be tricky. Follow the official installation guide for your operating system.*

2.  **Configure Your Bot**: Edit `config.py` and your `.env` file with your settings and API keys.

3.  **Start the Bot**:
    ```bash
    python main.py
    ```

The bot will initialize, load your strategy, and start listening for market data to trade.

## üìù Logging

The bot creates a log file specified in `config.py` (default: `logs/trading_bot.log`). This file contains detailed information about the bot's activities, including signals, orders, and errors. Check this file to monitor the bot's performance and troubleshoot any issues.