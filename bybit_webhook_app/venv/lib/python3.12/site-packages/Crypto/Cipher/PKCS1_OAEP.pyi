from collections.abc import Callable
from typing import Any
from typing import Union

from typing_extensions import Protocol

from Crypto.PublicKey.RSA import RsaKey

class HashLikeClass(Protocol):
    digest_size : int
    def new(self, data: bytes | None = ...) -> Any: ...

class HashLikeModule(Protocol):
    digest_size : int
    @staticmethod
    def new(data: bytes | None = ...) -> Any: ...

HashLike = Union[HashLikeClass, HashLikeModule]

Buffer = Union[bytes, bytearray, memoryview]

class PKCS1OAEP_Cipher:
    def __init__(self,
                 key: RsaKey,
                 hashAlgo: HashLike,
                 mgfunc: Callable[[bytes, int], bytes],
                 label: Buffer,
                 randfunc: Callable[[int], bytes]) -> None: ...
    def can_encrypt(self) -> bool: ...
    def can_decrypt(self) -> bool: ...
    def encrypt(self, message: Buffer) -> bytes: ...
    def decrypt(self, ciphertext: Buffer) -> bytes: ...

def new(key: RsaKey,
        hashAlgo: HashLike | None = ...,
        mgfunc: Callable[[bytes, int], bytes] | None = ...,
        label: Buffer | None = ...,
        randfunc: Callable[[int], bytes] | None = ...) -> PKCS1OAEP_Cipher: ...
